{% extends 'layouts/main.html' %}

{% block content %}
   <div class="row">
      <div class="col-md-12">
         <div id="kanban"></div>
      </div>
   </div>
{% endblock %}

{% block additional_js %}
<script>
$(document).ready(function() {

    $.ajax({
        url: '{{ url_for('api_atividades_get') }}'
    }).done(function(quadros){
        const Kanban = new jKanban({
                element : '#kanban',
                addItemButton: true,
                buttonClick: function(btn, estagioId){
                  console.log(btn);
                  console.log(estagioId);
                },
                dropEl: function (el, target) {

                    $.post({
                        url: '{{ url_for('api_trocar_estagio_atividade') }}',
                        data: {
                            'atividade_id': $(el).data('eid'),
                            'estagio_id': $(target).parent().data('id')
                        },
                        dataType: 'json'
                    }).fail(function(error) {
                        console.log(error);
                    });

                },
                dragendBoard: function(board){

                    $.post({
                        url: '{{ url_for('api_trocar_ordem_estagio') }}',
                        data: {
                            'atividade_id': $(el).data('eid'),
                            'estagio_id': $(target).parent().data('id')
                        },
                        dataType: 'json'
                    }).fail(function(error) {
                        console.log(error);
                    });

                    console.log(board.dataset);
                },
                boards  :quadros
        });
    });

});
</script>
{% endblock %}